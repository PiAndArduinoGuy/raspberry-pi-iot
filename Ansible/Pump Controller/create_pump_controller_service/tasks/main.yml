---
- name: Clear previous pump-controller service
  include_role:
    name: "../Common/clear_previous_service"
  vars:
    - service_name: "pump-controller"

- name: Extract jar name from {{pump_controller_zip_name}}
  set_fact:
    pump_controller_jar_name: "{{pump_controller_zip_name.split('.')[0]}}"

- debug:
    msg: "Jar name is {{pump_controller_jar_name}}"

- name: Create a systemd service of the Pump Controller.
  become: yes
  template:
    src: service.j2
    dest: "{{base_services_location}}/pump-controller.service"
    owner: root
    mode: "777"

- name: Reload the systemd daemon, ensuring changes to unit files take proper effect.
  become: yes
  systemd:
    daemon_reload: yes
